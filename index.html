<!DOCTYPE html>
<html>
<head>
	
	<title>Mobile tutorial - Leaflet</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js" integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og==" crossorigin=""></script>
	<script src="https://unpkg.com/papaparse@5.1.0/papaparse.min.js"></script>

	<style>
		html, body {
			height: 100%;
			margin: 0;
		}
		#map {
			width: 600px;
			height: 400px;
		}
	</style>

	<style>body { padding: 0; margin: 0; } #map { height: 100%; width: 100vw; }</style>
</head>
<body>

<div id='map'></div>

<script>	

	var data = '[{"Jour":"2019-10-07","Heure":"10:30:00","PM1":2,"PM2.5":4,"PM10":7,"Latitude":48.5989635,"Longitude":7.7424285},{"Jour":"2019-10-07","Heure":"10:30:15","PM1":3,"PM2.5":9,"PM10":15,"Latitude":48.599227,"Longitude":7.7425905},{"Jour":"2019-10-07","Heure":"10:30:30","PM1":3,"PM2.5":9,"PM10":15,"Latitude":48.599787,"Longitude":7.743076},{"Jour":"2019-10-07","Heure":"10:30:45","PM1":4,"PM2.5":12,"PM10":20,"Latitude":48.6001045,"Longitude":7.7433635},{"Jour":"2019-10-07","Heure":"10:31:00","PM1":4,"PM2.5":12,"PM10":20,"Latitude":48.600805,"Longitude":7.7441735},{"Jour":"2019-10-07","Heure":"10:31:15","PM1":5,"PM2.5":15,"PM10":26,"Latitude":48.601552,"Longitude":7.744991},{"Jour":"2019-10-07","Heure":"10:31:30","PM1":6,"PM2.5":18,"PM10":31,"Latitude":48.602008,"Longitude":7.7453725},{"Jour":"2019-10-07","Heure":"10:31:45","PM1":7,"PM2.5":21,"PM10":36,"Latitude":48.602382,"Longitude":7.7456915},{"Jour":"2019-10-07","Heure":"10:32:00","PM1":6,"PM2.5":18,"PM10":31,"Latitude":48.6031325,"Longitude":7.7462945},{"Jour":"2019-10-07","Heure":"10:32:15","PM1":6,"PM2.5":18,"PM10":31,"Latitude":48.603881,"Longitude":7.7468995},{"Jour":"2019-10-07","Heure":"10:32:30","PM1":5,"PM2.5":15,"PM10":26,"Latitude":48.6043765,"Longitude":7.747312},{"Jour":"2019-10-07","Heure":"10:32:45","PM1":5,"PM2.5":15,"PM10":26,"Latitude":48.604956,"Longitude":7.747782},{"Jour":"2019-10-07","Heure":"10:33:00","PM1":4,"PM2.5":12,"PM10":20,"Latitude":48.6055315,"Longitude":7.748259},{"Jour":"2019-10-07","Heure":"10:33:15","PM1":4,"PM2.5":12,"PM10":20,"Latitude":48.606239,"Longitude":7.748811},{"Jour":"2019-10-07","Heure":"10:33:30","PM1":5,"PM2.5":15,"PM10":26,"Latitude":48.606777,"Longitude":7.749226},{"Jour":"2019-10-07","Heure":"10:33:45","PM1":5,"PM2.5":15,"PM10":26,"Latitude":48.6074885,"Longitude":7.7496735}]'



	var map = L.map('map').fitWorld();

	L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox.streets'
	}).addTo(map);

	function onLocationFound(e) {
		var radius = e.accuracy / 2;

		L.marker(e.latlng).addTo(map)
			.bindPopup("You are within " + radius + " meters from this point").openPopup();

		L.circle(e.latlng, radius).addTo(map);
	}

	function onLocationError(e) {
		alert(e.message);
	}

	map.on('locationfound', onLocationFound);
	map.on('locationerror', onLocationError);
	
	
	//Marker part  DEV ONLY
	//https://www.papaparse.com/
	
	//L.marker([48.582305, 7.764928]).addTo(map);
	//END marker part
	
	
	
	
	//Add points   
	
	count = 1;
	var files = ["data/RSens_1_Data_2019-10-07.csv"];
	//var file = new File("data/RSens_1_Data_2019-10-07.csv");
	var results = Papa.parse(data, {
		worker: true, // Don't bog down the main thread if its a big file
		step: function(result) {
			//L.marker([result.data[1].Latitude, result.data[1].Longitude]).addTo(map);
			console.log(result.data); 
		},
		complete: function(results, file) {
			console.log('parsing complete read', count, 'records.'); 
		}
	});
	//END add points

	map.locate({setView: true, maxZoom: 16});
</script>



</body>
</html>